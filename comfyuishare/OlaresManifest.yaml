olaresManifest.version: '0.10.0'
olaresManifest.type: app
metadata:
  name: comfyuishare
  description: The most powerful and modular stable diffusion GUI and backend.
  icon: https://app.cdn.olares.com/appstore/comfyui/icon2.png
  appid: comfyuishare
  version: '1.2.25'
  title: ComfyUI Shared
  categories:
  - Creativity
  - Productivity
entrances:
- name: comfyuientrance
  host: comfyuientrance
  port: 8080
  title: ComfyUI
  icon: https://app.cdn.olares.com/appstore/comfyui/icon2.png
  authLevel: internal
  openMethod: window
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
- name: comfyuilauncherweb
  host: comfyuientrance
  port: 8081
  title: ComfyUI Launcher
  icon: https://app.cdn.olares.com/appstore/comfyui/launcher2.png
  authLevel: private
{{- end }}
# - name: comfyuilauncherserver
#   host: comfyuientrance
#   port: 8082
#   title: Comfyui Launcher Server
#   icon: https://app.cdn.olares.com/appstore/comfyui/icon.png
#   authLevel: public
#   invisible: true
permission:
  provider:
  - appName: olares-app
    providerName: desktop
  appData: true
  appCache: true
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
  userData:
  - Home
  sysData:
  - dataType: legacy_api
    group: api.intent
    appName: desktop
    svc: edge-desktop
    namespace: user-space
    port: 80
    version: v1
    ops:
    - POST
{{- end }}
spec:
  versionName: '0.3.65'
  featuredImage: https://app.cdn.olares.com/appstore/comfyui/1.png
  promoteImage:
  - https://app.cdn.olares.com/appstore/comfyui/1.png
  - https://app.cdn.olares.com/appstore/comfyui/2.png
  - https://app.cdn.olares.com/appstore/comfyui/3.png
  - https://app.cdn.olares.com/appstore/comfyui/4.png
  fullDescription: |
    ## IMPORTANT NOTE ##
    This is a shared version of ComfyUI. Only one service will be installed across the entire Olares system. However, every user still needs to install an desktop entry to access and use the service installed by the Olares Admin.

    After installation, everyone on this Olares cluster can use the same application. This shared setup makes it easier for users to share information with each other, while reducing maintenance work and using fewer resources.

    ## OVERVIEW ##
    The most powerful and modular stable diffusion GUI and backend.

    This ui will let you design and execute advanced stable diffusion pipelines using
    a graph/nodes/flowchart based interface.

    Features
    - Nodes/graph/flowchart interface to experiment and create complex Stable Diffusion workflows without needing to code anything.
    - Image Models
      * SD1.x, SD2.x,
      * SDXL, SDXL Turbo
      * Stable Cascade
      * SD3 and SD3.5
      * Pixart Alpha and Sigma
      * AuraFlow
      * HunyuanDiT
      * Flux
      * Lumina Image 2.0
      * HiDream
      * Cosmos Predict2
      * Qwen Image
    - Image Editing Models
      * Omnigen 2
      * Flux Kontext
      * HiDream E1.1
      * Qwen Image Edit
    - Video Models
      * Stable Video Diffusion
      * Mochi
      * LTX-Video
      * Hunyuan Video
      * Nvidia Cosmos and Cosmos Predict2
      * Wan 2.1
      * Wan 2.2
    - Audio Models
      * Stable Audio
      * ACE Step
    - 3D Models
      * Hunyuan3D 2.0
    - Asynchronous Queue system
    - Many optimizations: Only re-executes the parts of the workflow that changes between executions.
    - Smart memory management: can automatically run models on GPUs with as low as 1GB vram.
    - Works even if you don't have a GPU with: --cpu (slow)
    - Can load ckpt, safetensors and diffusers models/checkpoints. Standalone VAEs and CLIP models.
    - Embeddings/Textual inversion
    - Loras (regular, locon and loha)
    - Hypernetworks
    - Loading full workflows (with seeds) from generated PNG, WebP and FLAC files.
    - Saving/Loading workflows as Json files.
    - Nodes interface can be used to create complex workflows like one for Hires fix or much more advanced ones.
    - Area Composition
    - Inpainting with both regular and inpainting models.
    - ControlNet and T2I-Adapter
    - Upscale Models (ESRGAN, ESRGAN variants, SwinIR, Swin2SR, etc...)
    - unCLIP Models
    - GLIGEN
    - Model Merging
    - LCM models and Loras
    - Latent previews with TAESD
    - Starts up very fast.
    - Works fully offline: core will never download anything unless you want to.
    - Optional API nodes to use paid models from external providers through the online Comfy API.
    - Config file to set the search paths for models.

  upgradeDescription: |
    Update ComfyUI to v0.3.65

    What's Changed
    feat(V3-io): allow Enum classes for Combo options by @bigcat88 in #10237
    Refactor model sampling sigmas code. by @comfyanonymous in #10250
    Mvly/node update by @Kosinkadink in #10042
    feat(api-nodes, pylint): use lazy formatting in logging functions by @bigcat88 in #10248
    [V3] convert nodes_model_downscale.py to V3 schema by @bigcat88 in #10199
    [V3] convert nodes_lora_extract.py to V3 schema by @bigcat88 in #10182
    [V3] convert nodes_compositing.py to V3 schema by @bigcat88 in #10174
    [V3] convert nodes_latent.py to V3 schema by @bigcat88 in #10160
    More surgical fix for #10267 by @comfyanonymous in #10276
    fix(v3,api-nodes): V3 schema typing; corrected Pika API nodes by @bigcat88 in #10265
    [V3] convert nodes_sd3.py and nodes_slg.py to V3 schema by @bigcat88 in #10162
    Fix bug with applying loras on fp8 scaled without fp8 ops. by @comfyanonymous in #10279
    [V3] convert nodes_flux to V3 schema by @bigcat88 in #10122
    [V3] convert nodes_upscale_model.py to V3 schema by @bigcat88 in #10149
    Fix save audio nodes saving mono audio as stereo. by @comfyanonymous in #10289
    feat(GeminiImage-ApiNode): add aspect_ratio and release version of model by @bigcat88 in #10255
    feat(api-nodes): add price extractor feature; small fixes to Kling/Pika by @bigcat88 in #10284
    Update template to 0.1.95 by @comfyui-wiki in #10294
    Implement the mmaudio 16k VAE. by @comfyanonymous in #10300
    Improve AMD performance. by @comfyanonymous in #10302
    Update node docs to 0.3.0 by @comfyui-wiki in #10318
    update extra models paths example "clip" -> "text_encoders" by @christian-byrne in #10316
    Update the extra_model_paths.yaml.example by @comfyanonymous in #10319
    Always set diffusion model to eval() mode. by @comfyanonymous in #10331
    add indent=4 kwarg to json.dumps() in "Preview Any" node by @norgeous in #10307
    WAN2.2: Fix cache VRAM leak on error by @rattus128 in #10308
    [V3] convert nodes_hunyuan.py to V3 schema by @bigcat88 in #10136
    Enable RDNA4 pytorch attention on ROCm 7.0 and up. by @comfyanonymous in #10332
    Fix loading old stable diffusion ckpt files on newer numpy. by @comfyanonymous in #10333
    Better memory estimation for the SD/Flux VAE on AMD. by @comfyanonymous in #10334

    View full release note at: https://github.com/comfyanonymous/ComfyUI/releases/tag/v0.3.65  developer: Comfy Org
  website: https://www.comfy.org/
  sourceCode: https://github.com/comfyanonymous/ComfyUI
  submitter: Olares
  locale:
  - en-US
  - zh-CN
  doc: https://docs.comfy.org/get_started/introduction
  license:
  - text: GPL-3.0
    url: https://github.com/comfyanonymous/ComfyUI?tab=GPL-3.0-1-ov-file#readme
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
  requiredGpu: 2Gi
  requiredMemory: 2Gi
  requiredCpu: 0.25
  requiredDisk: 10Gi
  limitedGpu: 16Gi
  limitedMemory: 50.5Gi
  limitedCpu: 4.1
  limitedDisk: 40Gi
{{- else }}
  requiredMemory: 64Mi
  limitedMemory: 256Mi
  requiredDisk: 1Mi
  limitedDisk: 100Mi
  requiredCpu: 10m
  limitedCpu: 100m
{{- end }}
  supportArch:
  - amd64
options:
  apiTimeout: 0
  conflicts:
  - name: comfyui
    type: application
  - name: comfyuiclient
    type: application  
  dependencies:
  - name: olares
    type: system
    version: '>=1.11.6-0'
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
{{- else }}
  - name: comfyuishare
    type: application
    version: '>=1.2.0'
    mandatory: true
{{- end }}
  appScope:
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}  
    clusterScoped: true
    appRef:
    - comfyuishare
{{- else }}
    clusterScoped: false
{{- end }}