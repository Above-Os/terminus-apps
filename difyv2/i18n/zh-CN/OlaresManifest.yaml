metadata:
  description: GenAI 应用的创新引擎
  title: Dify 共享版
spec:
  fullDescription: |
    ## 重要提示 ##
    本应用是 Dify 共享版本，在 Olares 内部仅会部署一个服务。注意，每个用户仍需要安装一个桌面入口才能访问和使用 Olares 管理员安装的服务。
    
    安装后，该 Olares 服务器内的所有用户都能共同使用这同一个应用服务。使用共享应用不仅能方便用户数据的共享与互通，也能有效降低维护和运行资源的占用。

    ## 迁移说明 ##
    如果您使用的是旧版本的 Dify，它可能与 Dify v1.0 或更高版本冲突。我们建议您备份数据，卸载旧版本，然后安装此最新版本。

    ## 应用概览 ##
    Dify 是一个开源的 LLM 应用开发平台。其直观界面融合了 AI 工作流、RAG pipeline、代理能力、模型管理、可观测性功能等，让您能快速从原型转向生产。以下是核心功能列表：

    1. 工作流：在可视化画布上构建和测试强大的 AI 工作流，充分利用下述功能。

    2. 全面的模型支持：与数十家推理提供商和自托管解决方案的数百种专有/开源 LLM 无缝集成，涵盖 GPT、Mistral、Llama3 和任何与 OpenAI API 兼容的模型。支持的模型提供商的完整列表可在此处找到。

    3. Prompt IDE：直观的界面，用于制作提示、比较模型性能以及向基于聊天的应用程序添加文本转语音等其他功能。

    4. RAG Pipeline：广泛的 RAG 功能，涵盖从文档提取到检索的所有内容，开箱即用地支持从 PDF、PPT 和其他常见文档格式中提取文本。

    5. 代理功能：您可以基于 LLM 函数调用或 ReAct 定义代理，并为代理添加预构建或自定义工具。Dify 为 AI 代理提供了 50 多种内置工具，例如 Google Search、DELL·E、Stable Diffusion 和 WolframAlpha。

    6. LLMOps：监控和分析应用程序日志和性能。您可以根据生产数据和注释不断改进提示、数据集和模型。

    7. 后端即服务：Dify 的所有产品都配有相应的 API，因此您可以毫不费力地将 Dify 集成到您自己的业务逻辑中。
  upgradeDescription: |
    升级至 Dify v1.13.0 - 人机协作和工作流执行升级

    ## 新功能

    ### 人机协作（Human-in-the-Loop, HITL）

    我们引入了 **人工输入** 节点，这是一个重大更新，改变了 AI 和人类在 Dify 工作流中的协作方式。

    **核心能力：**

    - **原生工作流暂停：** 在关键决策点插入"人工输入"节点以暂停工作流执行。
    - **审查和编辑：** 节点生成一个 UI，人类可以在流程继续之前审查 AI 输出并修改变量（例如，编辑草稿或更正数据）。
    - **基于操作的路由：** 配置自定义按钮（如"批准"、"拒绝"或"升级"），这些按钮决定工作流的后续路径。
    - **灵活的交付方式：** 人工输入表单可以通过 **Webapp** 或 **Email** 交付。在云环境中，Email 交付的可用性可能取决于计划/功能设置。

    ## 架构更新

    为了支持 HITL 所需的有状态暂停/恢复机制并提供事件订阅 API，我们重构了执行引擎：**基于工作流的流式执行和高级聊天执行现在在 Celery workers 中运行**，而非流式 **WORKFLOW** 运行仍在 API 进程中执行。所有暂停/恢复路径（例如 HITL）都通过 Celery 恢复，事件通过 Redis Pub/Sub 流式传输回来。

    **对于大型部署和自托管用户：**

    我们引入了一个名为 `workflow_based_app_execution` 的新 Celery 队列。虽然标准设置可以开箱即用，但高吞吐量环境应考虑以下优化：

    1. **扩展 Workers：** 根据您的特定工作负载调整使用 `workflow_based_app_execution` 队列的 workers 数量。
    2. **专用 Redis（可选）：** 对于大规模部署，我们建议配置新的 `PUBSUB_REDIS_URL` 环境变量，指向专用的 Redis 实例。强烈建议使用 **Redis 集群模式与分片 PubSub** 以确保水平可扩展性。

    ## 重要升级说明

    **需要新的 Celery 队列：`workflow_based_app_execution`**

    请确保您的部署配置包含监听新的 **`workflow_based_app_execution`** 队列的 workers。此队列是工作流流式执行和所有恢复流程（例如 HITL）所必需的；否则，流式执行和恢复任务将无法处理。

    ## 其他更新

    - 增强的工作流运行历史管理和 UI 更新
    - API 端点和数据库操作的性能优化
    - 平台范围内的多个错误修复和改进
    - 支持 nl-NL 语言
    
    完整发布说明请见：https://github.com/langgenius/dify/releases/tag/1.13.0